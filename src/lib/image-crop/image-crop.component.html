<div class="image-crop">
    <div class="display" tabindex="0">
        <svg #display version="1.1" class="mask" attr.viewBox="0 0 {{cropped.image.width}} {{cropped.image.height}}" preserveAspectRatio="xMinYMin meet">
			<defs>
				<mask id="image-crop-mask" clipPathUnits="objectBoundingBox">
					<rect attr.x="{{cropped.x}}" attr.y="{{cropped.y}}" attr.width="{{cropped.mask.width}}" attr.height="{{cropped.mask.height}}" fill="white" />
					<rect x="0" y="0" attr.width="{{cropped.image.width}}" attr.height="{{cropped.image.height}}" opacity="0.2" fill="white" />
				</mask>
			</defs>
			<g mask="url(#image-crop-mask)" pinchresize [attr.width]="cropped.mask.width" [attr.height]="cropped.mask.height" (sizeChange)="onSizeChange($event)">
				<image class="image" attr.height="{{cropped.image.height}}" attr.width="{{cropped.image.width}}" attr.transform="rotate({{cropped.rotation}} {{cropped.image.width/2}} {{cropped.image.height/2}})" [attr.xlink:href]="cropped.image.url" preventDefault />
				<rect class="masked-area" dragmove [x]="cropped.x" [y]="cropped.y" (locationChange)="onPan($event)" attr.x="{{cropped.x}}" attr.y="{{cropped.y}}" attr.width="{{cropped.mask.width}}" attr.height="{{cropped.mask.height}}" fill="black" fill-opacity="0"/>
			</g>
		</svg>
    </div>
    <div class="rotator" [style.height.px]="viewHeight">
        <rotator [rotation]="cropped.rotation" (rotationChange)="rotateTo($event)"></rotator>
    </div>
</div>